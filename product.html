
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Closette Studios</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">

  <style>
    .thumb-selected { border: 2px solid black; }
    .zoom-image:hover { transform: scale(1.05); transition: transform 0.3s ease; }
    .size-btn.selected { background-color: #f87171; color: white; border-color: #f87171; }
    .bounce {
      animation: bounce 0.5s ease;
    }
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .removed {
  opacity: 0.35;
  filter: grayscale(60%);
  background-color: #fef2f2;
  border: 2px dashed #f87171;
  position: relative;
  transition: all 0.3s ease;
}

/* Re-enable interaction only on the restore button */
.removed button.restore-btn {
  pointer-events: auto;
}

#productList::-webkit-scrollbar {
  width: 6px;
}
#productList::-webkit-scrollbar-thumb {
  background-color: #aaa;
  border-radius: 4px;
}

  .custom-scroll::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scroll::-webkit-scrollbar-thumb {
    background: #aaa;
    border-radius: 3px;
  }

  .custom-scroll::-webkit-scrollbar-track {
    background: transparent;
  }


.removed img {
  opacity: 0.5;
}

.removed .text-gray-600,
.removed .font-semibold {
  text-decoration: line-through;
  color: #a1a1aa;
}

.restore-btn {
  color: #15803d;
}

.remove-btn {
  color: #dc2626;
}


    @media (max-width: 640px) {
      #product-detail .flex.md\:flex-row {
        flex-direction: column;
      }

        ::-webkit-scrollbar {
    width: 6px;
  }

  ::-webkit-scrollbar-thumb {
    background: #aaa;
    border-radius: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
      

      #product-detail .flex.md\:flex-row > .flex > div:first-child {
        flex-direction: row;
        overflow-x: auto;
      }

      #product-detail .flex.md\:flex-row > .flex > div:first-child > div {
        flex-shrink: 0;
      }

      #product-detail h2,
      #product-detail p,
      #product-detail button,
      #reviews-section h2,
      #reviews-section h3 {
        font-size: 90% !important;
      }

      #product-detail .w-\[500px\],
      #product-detail .h-\[500px\] {
        width: 100% !important;
        height: auto !important;
      }

      #related-list {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
      }

      #related-list > div {
        width: auto !important;
      }

      #related-list img {
        height: 150px !important;
      }

      #related-list p {
        font-size: 90%;
      }

      #related-list button {
        font-size: 10px;
      }

      #review-list p,
      #review-list span,
      #review-list .text-sm {
        font-size: 90% !important;
      }
    }
  </style>
</head>
<body class="bg-white text-gray-800 font-sans">

<header class="flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b">
  <!-- Left: Logo/Title -->
  <a href="first.html" class="text-xl sm:text-2xl font-bold">CLOSETTE STUDIOS</a>

  <!-- Right: Icons -->
  <div class="flex items-center gap-4">
    <!-- Outfit Ideas Icon -->
    <a href="outfit-ideas.html" title="Outfit Ideas">
      <img src="https://img.icons8.com/ios-filled/100/hanger.png " loading="lazy" alt="Outfit Ideas"
        class="w-8 h-8 sm:w-9 sm:h-9 hover:scale-110 transition-transform duration-300" />
    </a>

    <!-- Cart Icon -->
    <button id="cart-button" onclick="location.href='cart.html'" class="relative">
      <img src="https://img.icons8.com/ios-filled/100/shopping-cart.png" loading="lazy"
        class="w-9 h-9 sm:w-10 sm:h-10" alt="Cart" />
      <span id="cart-count"
        class="absolute -top-1 -right-1 bg-pink-600 text-white text-[10px] font-semibold rounded-full w-4 h-4 flex items-center justify-center shadow-md">
        0
      </span>
    </button>
  </div>
</header>


<main class="p-4 max-w-5xl mx-auto">
  <div id="product-detail" class="bg-white rounded-lg mb-10"></div>

  <!-- Related Products -->
  <div id="related-products" class="mt-20 bg-gradient-to-b from-pink-50 via-white to-white py-12 px-4 sm:px-6 hidden rounded-xl shadow-inner">
    <h3 class="text-lg sm:text-xl font-medium text-gray-700 mb-3 text-center">Related Products</h3>
    <div id="related-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6 max-w-6xl mx-auto"></div>
  </div>
</main>

<!-- Customer Reviews Section 
<section class="mt-20 bg-pink-50 py-12 rounded-xl shadow-inner px-4 sm:px-6" id="reviews-section">
  <div class="max-w-5xl mx-auto">
    <h2 class="text-xl sm:text-3xl font-extrabold text-center text-gray-800 mb-6 sm:mb-8">Customer Reviews</h2>
-->
    <!-- Rating Summary 
    <div class="flex flex-col items-center mb-8 sm:mb-10">
      <div class="flex items-center space-x-2">
        <span class="text-3xl sm:text-4xl font-bold text-yellow-500" id="avg-rating">0.0</span>
        <span class="text-sm text-gray-600">/ 5</span>
      </div>
      <div class="text-sm text-gray-500">based on <span id="total-reviews">0</span> reviews</div>
    </div>
-->
    <!-- Reviews Grid 
    <div id="review-list" class="grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3"></div>

    <div class="mt-10 sm:mt-12 bg-white shadow-lg rounded-xl p-4 sm:p-6 max-w-xl mx-auto">
      <h3 class="text-lg sm:text-xl font-semibold mb-4 text-gray-800">Write a Review</h3>
      <div class="flex gap-1 mb-3" id="star-input"></div>
      <textarea id="review-text" rows="3" class="w-full border border-gray-300 rounded-lg p-2 text-sm mb-3 focus:outline-none focus:ring-2 focus:ring-pink-300" placeholder="Write your review..."></textarea>
      <input id="review-name" type="text" placeholder="Your Name (optional)" class="w-full border border-gray-300 rounded-lg p-2 text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-pink-300" />
      <button onclick="submitReview()" class="bg-pink-500 hover:bg-pink-600 text-white px-6 py-2 rounded-lg shadow font-semibold">Submit Review</button>
    </div>
  </div>

  -->
</section>
<script>
  const data = JSON.parse(localStorage.getItem('selectedCollection')) || {};
  const allImages = [data.model_image, ...(data.products || []).map(p => p.image)];
  let selectedClothingSize = "M";
  let selectedShoeSize = "UK 7";
  let removedIndexes = new Set();

  const offPercent = data.off || 0;

  const container = document.getElementById("product-detail");
  container.innerHTML = `
    <div class="flex flex-col md:flex-row gap-6 items-start">
<div class="hidden sm:flex gap-4 w-full md:w-7/12">
  <!-- üîΩ Scrollable vertical thumbnails -->
<div class="flex flex-col gap-2 overflow-y-auto h-[340px] pr-1 scroll-smooth flex-shrink-0">
  ${allImages.map((img, index) => `
    <div class="w-20 h-20 flex-shrink-0 border rounded overflow-hidden">
      <img src="${img}" onclick="setActiveImage('${img}', this)" loading="lazy"
           class="w-full h-full object-cover cursor-pointer rounded border ${index === 0 ? 'thumb-selected' : ''}" />
    </div>
  `).join('')}
</div>





  <!-- üñºÔ∏è Main Image -->
  <div class="w-[400px] h-[400px] border rounded overflow-hidden flex items-center justify-center">
    <img id="mainImage" src="${data.model_image}" loading="lazy" class="w-full h-full object-cover zoom-image" />
  </div>
</div>





      <!-- ‚úÖ Mobile View -->
      <div class="flex sm:hidden flex-col gap-2 w-full items-center">
        <div class="w-[300px] h-[300px] border rounded overflow-hidden flex items-center justify-center">
          <img id="mainImage" src="${data.model_image}" style="width:300px; height:300px;"  loading="lazy" class="object-cover zoom-image" />
        </div>

        <!-- Scrollable Horizontal Thumbnails -->
        <div class="w-full overflow-x-auto">
          <div class="flex gap-2 w-max px-2">
            ${allImages.map((img, index) => `
              <div class="w-20 h-20 flex-shrink-0 border rounded overflow-hidden">
                <img src="${img}" onclick="setActiveImage('${img}', this)" loading="lazy"
                     class="w-full h-full object-cover cursor-pointer rounded border ${index === 0 ? 'thumb-selected' : ''}" />
              </div>
            `).join('')}
          </div>
        </div>
      </div>

      <!-- ‚úÖ Product Details -->
      <div class="w-full md:w-5/12">
        <h2 class="text-xl font-semibold mb-2">${data.title}</h2>

        <div class="mb-3">
          <div id="clothingSizeOptions" class="flex gap-2 flex-wrap">
            ${["XS", "S", "M", "L", "XL"].map(size => `
              <button onclick="selectClothingSize('${size}', this)"
                      class="size-btn px-3 py-1 border rounded text-sm">${size}</button>
            `).join("")}
          </div>
        </div>

        <div class="mb-3">
          <div id="shoeSizeOptions" class="flex gap-2 flex-wrap">
            ${["UK 5", "UK 6", "UK 7", "UK 8"].map(size => `
              <button onclick="selectShoeSize('${size}', this)"
                      class="size-btn px-3 py-1 border rounded text-sm">${size}</button>
            `).join("")}
          </div>
        </div>

        <!-- ‚úÖ Scrollable Product List -->
        <div class="space-y-2 mb-6 overflow-y-auto pr-1" id="productList" style="max-height: 18rem;">
          ${data.products.map((img, i) => `
            <div class="flex items-center gap-3 p-2 border rounded" id="product-${i}">
              <img src="${data.products[i].image}" loading="lazy" class="w-14 h-14 object-cover rounded" />
              <div class="flex-1">
                <p class="text-sm font-medium">Product ${i + 1}</p>
                <p class="text-xs text-gray-600">Price: ‚Çπ${data.products[i].price}</p>
              </div>
              <button onclick="removeProduct(${i})" class="text-xs text-red-500 hover:underline">‚ùå Remove</button>
            </div>
          `).join("")}
        </div>

        <!-- ‚úÖ Pricing Section -->
        <div class="text-2xl font-bold text-left mb-4 text-gray-800">
          <span class="line-through text-gray-400 text-lg">‚Çπ<span id="original-price">0</span></span>
          <span class="text-pink-600 ml-2">‚Çπ<span id="discounted-price">0</span></span>
          <span id="discount-label" class="text-green-600 text-sm ml-1"></span>
        </div>

        <!-- ‚úÖ Action Buttons -->
        <div class="flex items-center gap-3">
          <button id="addToCartBtn" onclick="addToCart()" class="bg-red-600 hover:bg-red-700 text-white w-4/5 py-2 rounded transition-all duration-300">
            Add to Cart
          </button>
          <button id="addToWishlistBtn" onclick="addToWishlist()" class="border border-pink-400 text-pink-600 hover:bg-pink-100 p-2 rounded-full text-xl">
            ‚ù§Ô∏è
          </button>
        </div>
      </div>
    </div>
  `;


          updateTotalPrice();

  function setActiveImage(src, clickedThumb) {
  // Update both mobile and desktop preview images
  const mainImages = document.querySelectorAll("#mainImage");
  mainImages.forEach(img => img.src = src);

  // Remove selection highlight from all thumbnails
  document.querySelectorAll(".thumb-selected").forEach(el => el.classList.remove("thumb-selected"));
  
  // Add selection highlight to the clicked thumbnail
  clickedThumb.classList.add("thumb-selected");
}



  function selectClothingSize(size, btn) {
    selectedClothingSize = size;
    document.querySelectorAll('#clothingSizeOptions .size-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
  }

  function selectShoeSize(size, btn) {
    selectedShoeSize = size;
    document.querySelectorAll('#shoeSizeOptions .size-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
  }

  function removeProduct(index) {
  removedIndexes.add(index);
  updateTotalPrice();
}

function restoreProduct(index) {
  removedIndexes.delete(index);
  updateTotalPrice();
}

  function getActiveProducts() {
    return data.products.filter((_, i) => !removedIndexes.has(i));
  }
  function addToCart() {
  const cart = JSON.parse(localStorage.getItem("cartItems")) || [];

  const activeProducts = getActiveProducts();
  const originalPrice = activeProducts.reduce((sum, p) => sum + p.price, 0);
  const discount = data.off || 0;
  const discountedPrice = Math.round(originalPrice * (1 - discount / 100));

  cart.push({
    collection_id: data.collection_id,
    title: data.title,
    model_image: data.model_image,
    category: data.category,
    price: discountedPrice, // ‚úÖ Only discounted price is stored
    clothingSize: selectedClothingSize,
    shoeSize: selectedShoeSize,
    includedProducts: activeProducts.map(p => ({
      ...p,
      product_id: p.product_id
    }))
  });

  localStorage.setItem("cartItems", JSON.stringify(cart));

  const btn = document.getElementById("addToCartBtn");
  btn.innerHTML = "üéâ Added to Cart!";
  btn.classList.remove("bg-red-600", "hover:bg-red-700");
  btn.classList.add("bg-green-600", "hover:bg-green-700", "bounce");
  setTimeout(() => btn.classList.remove("bounce"), 600);

    updateCartCount();
}

  function addToWishlist() {
    const wishlist = JSON.parse(localStorage.getItem("wishlistItems")) || [];
    wishlist.push({
      title: data.title,
      model_image: data.model_image,
      category: data.category,
      price: data.products.length * 999 - 1000,
      clothingSize: selectedClothingSize,
      shoeSize: selectedShoeSize,
      includedProducts: getActiveProducts()
    });
    localStorage.setItem("wishlistItems", JSON.stringify(wishlist));
    const btn = document.getElementById("addToWishlistBtn");
    btn.innerHTML = "üíñ";
    btn.classList.add("bg-pink-500", "text-white", "bounce");
    setTimeout(() => btn.classList.remove("bounce"), 600);
  }

  // Handle Related Products (only multiple of 3)
  fetch("collections.json").then(res => res.json()).then(collections => {
    const related = collections.filter(item => item.category === data.category && item.title !== data.title);
    const trimmed = related.length >= 3 ? related.slice(0, 3) : [];
    if (trimmed.length) {
      document.getElementById("related-products").classList.remove("hidden");
      document.getElementById("related-list").innerHTML = trimmed.map(item => `
        <div class="break-inside-avoid bg-white rounded-xl shadow hover:shadow-md transition overflow-hidden w-[220px]">
          <img src="${item.model_image}" loading="lazy" class="w-full h-[200px] object-cover rounded-t-xl" />
          <div class="p-3">
            <p class="text-sm font-semibold text-gray-800 truncate">${item.title}</p>
            <p class="text-xs text-gray-500">Category: ${item.category}</p>
            <p class="text-xs text-pink-600">‚Çπ${item.products.reduce((sum, p) => sum + p.price, 0)}
</p>
            <button onclick='selectRelated(${JSON.stringify(item)})'
              class="mt-2 inline-block text-[11px] bg-pink-100 text-pink-600 px-2 py-1 rounded-full hover:bg-pink-200 transition">
              View ‚Üí
            </button>
          </div>
        </div>
      `).join('');
    }
  });

  function selectRelated(item) {
    localStorage.setItem("selectedCollection", JSON.stringify(item));
    window.location.href = "product.html";
  }

let selectedRating = 0;

const starInput = document.getElementById("star-input");
starInput.innerHTML = [...Array(5)].map((_, i) => `
  <svg onclick="setRating(${i+1})" class="w-6 h-6 cursor-pointer text-gray-300 hover:text-yellow-400 transition"
       fill="currentColor" viewBox="0 0 20 20">
    <path d="M10 15l-5.878 3.09L5.82 11.545.94 7.41l6.09-.89L10 1.5l2.97 5.02 6.09.89-4.88 4.134 1.698 6.545z"/>
  </svg>`).join('');

function setRating(rating) {
  selectedRating = rating;
  const stars = document.querySelectorAll("#star-input svg");
  stars.forEach((star, i) => {
    star.classList.toggle("text-yellow-400", i < rating);
    star.classList.toggle("text-gray-300", i >= rating);
  });
}

function submitReview() {
  const text = document.getElementById("review-text").value.trim();
  const name = document.getElementById("review-name").value.trim() || "Anonymous";
  if (selectedRating === 0 || text === "") {
    alert("Please provide both rating and review.");
    return;
  }

  const reviews = JSON.parse(localStorage.getItem("productReviews")) || {};
  const currentTitle = data.title;
  if (!reviews[currentTitle]) reviews[currentTitle] = [];
  reviews[currentTitle].push({ name, rating: selectedRating, text });
  localStorage.setItem("productReviews", JSON.stringify(reviews));

  document.getElementById("review-text").value = "";
  document.getElementById("review-name").value = "";
  setRating(0);
  renderReviews();
}

function getActiveProducts() {
  return data.products.filter((_, i) => !removedIndexes.has(i));
}
function updateTotalPrice() {
  const activeProducts = getActiveProducts();
  const originalPrice = activeProducts.reduce((sum, p) => sum + p.price, 0);
  const discount = data.off || 0;
  const discountedPrice = Math.round(originalPrice * (1 - discount / 100));

  // Update DOM prices
  document.getElementById("original-price").textContent = originalPrice;
  document.getElementById("discounted-price").textContent = discountedPrice;
  document.getElementById("discount-label").textContent = `(${discount}% OFF)`;

  // Update product list UI
  const productList = document.getElementById("productList");
  productList.innerHTML = data.products.map((p, i) => {
    const isRemoved = removedIndexes.has(i);
    return `
      <div class="flex items-center gap-3 p-2 border rounded ${isRemoved ? 'removed' : ''}" id="product-${i}">
        <img src="${p.image}" loading="lazy" class="w-14 h-14 object-cover rounded" />
        <div class="flex-1">
          <p class="text-sm font-medium">Product ${i + 1}</p>
          <p class="text-xs text-gray-600">
            <span class="${isRemoved ? 'line-through text-gray-400' : 'font-semibold'}">‚Çπ${p.price}</span>
          </p>
        </div>
        <button onclick="${isRemoved ? `restoreProduct(${i})` : `removeProduct(${i})`}" 
                class="text-xs ${isRemoved ? 'restore-btn' : 'remove-btn'} hover:underline">
          ${isRemoved ? '‚ûï Restore' : '‚ùå Remove'}
        </button>
      </div>`;
  }).join('');
}






function renderReviews() {
  const reviewList = document.getElementById("review-list");
  const reviews = JSON.parse(localStorage.getItem("productReviews")) || {};
  const productReviews = reviews[data.title] || [];

  document.getElementById("total-reviews").textContent = productReviews.length;
  if (productReviews.length === 0) {
    document.getElementById("avg-rating").textContent = "0.0";
    reviewList.innerHTML = `<p class="text-center text-gray-500 col-span-full">No reviews yet. Be the first to share your thoughts!</p>`;
    return;
  }

  const avg = (productReviews.reduce((sum, r) => sum + r.rating, 0) / productReviews.length).toFixed(1);
  document.getElementById("avg-rating").textContent = avg;

  reviewList.innerHTML = productReviews.map(r => `
    <div class="bg-white p-4 rounded-xl shadow hover:shadow-md transition">
      <div class="flex items-center gap-2 mb-2">
        ${[1, 2, 3, 4, 5].map(i => `
          <svg class="w-4 h-4 ${i <= r.rating ? 'text-yellow-400' : 'text-gray-300'}"
               fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 15l-5.878 3.09L5.82 11.545.94 7.41l6.09-.89L10 1.5l2.97 5.02 6.09.89-4.88 4.134 1.698 6.545z"/>
          </svg>
        `).join('')}
        <span class="ml-auto text-xs text-gray-600 italic">${r.name}</span>
      </div>
      <p class="text-sm text-gray-700 leading-snug">${r.text}</p>
    </div>
  `).join('');
}

renderReviews();

      function updateCartCount() {
    const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
    document.getElementById('cart-count').textContent = cartItems.length;
  }

  // Call it once on page load
  updateCartCount();

</script>
<div class="h-10"></div>

</body>
</html>